(()=>{"use strict";window.base=((e={})=>{const t=window,n=document,r=n.documentElement||n.body,o=e=>typeof e,a=e=>Object.prototype.toString.call(e),s=o((()=>{})),c=a([]),i=o(""),l=Array.isArray?e=>Array.isArray(e):e=>a(e)===c,d=e=>{throw e},g=(e,t)=>d(`Invalid argument ${e}`+(t?`. Expecting (${t})`:"")),m=(e,t)=>{try{const n=JSON.parse(e,t);if(n&&"object"==typeof n)return n}catch(e){}},h=(e,t)=>{if(t)return o(t)===i?e.appendChild(n.createTextNode(t)):e.appendChild(t)},u=(e,t)=>{if(l(t))for(let n=0;n<t.length;n++)h(e,t[n]);else h(e,t)},p=new RegExp("[\\.\\|\\s]+","g"),v=(e,t,n)=>{const r=(e,t="|")=>e.replace(p,t).trim(),o=n?r(n," "):"",a=r(o+"|"+t);return e.className=(e.className.replace((e=>new RegExp("(^|\\s+)("+e+")\\s*(?=(\\s|$))","g"))(a),"")+(o.length?" "+o:"")).trim(),e},f=e=>"addEventListener"in e&&"removeEventListener"in e,y=e=>"attachEvent"in e&&"detachEvent"in e,E=(e,t,n,r)=>{if(f(e))return e.addEventListener(t,n,r),{h:n,stop:()=>b(e,t,n,r)};if(y(e)){const o=a=>{n.apply(e,a),r&&r.once&&e.detachEvent("on"+t,o)};return e.attachEvent("on"+t,o),{h:o,stop:()=>e.detachEvent("on"+t,o)}}d("Fail to add event listener.")},b=(e,t,n,r)=>{f(e)?e.removeEventListener(t,n,r):y(e)?e.detachEvent("on"+t,n):d("Fail to remove event listener.")},w=(e,t)=>{const n=e.indexOf(t);n>=0&&(delete e[n],w(e,t))},J=setTimeout,I=(e=>{if(e){const n=[],r=e=>{w(n,e)},a=e=>{o(e)===s&&n.push(e)},c=()=>{for(let e=0;e<n.length;e++)n[e]&&o(n[e])===s&&n[e]()},i=t=>e.getItem(t)||"",l=(t,n)=>{e.setItem(t,n),c()},d=t=>{e.removeItem(t),c()},g=t=>parseInt(""+(e.getItem(t)||0)),h=(e,t)=>l(e,""+t),u=(t,n="{}")=>m(e.getItem(t)||n)||m(n)||{},p=(e,t,n="{}")=>l(e,((e,t,n)=>{try{return JSON.stringify(e,t,n)}catch(e){}})(t)||n),v=t=>{const n=e.getItem(t),r=m(n),o=n&&!r;if(o){const e=`Base found corrupted data on [${t}].`;console.log("%c"+e,"color:tomato"),J((()=>{if(confirm(`${e} Recover bad data?`)){const e=`${t}.${Date.now().toString(36)}.x`,r=`Data has been recovered as [${e}].`;I.setString(e,n),J((()=>{console.log("%c"+r,"color:orange"),alert(r)}))}}))}return!o},f=()=>{let t=0;for(let n=0;n<e.length;n++){const r=e.key(n);r&&(t+=i(r).length)}return t};return E(t,"storage",c),{storage:e,getString:i,setString:l,getNumber:g,setNumber:h,getJson:u,setJson:p,validateJson:v,onChange:a,cleanOnChange:r,remove:d,size:f}}})(t.localStorage),S=(()=>{const e=I,t="base",n=e?(e.validateJson(t),e.getJson(t)):{},r=(r,o)=>(n[r]=o,!!e&&(e.setJson(t,n),true));return e.onChange((()=>{e.validateJson(t)||e.setJson(t,n)})),{get:e=>n[e],set:r,remove:e=>{r(e,undefined)}}})(),$=(()=>{const e="_color-scheme",a="theme";let s="",c=["_dark"],d=(e=>n.getElementById(e||""))(e);d||(d=((e,t,r)=>{const o=n.createElement(e);if(t)for(const e in t)o.setAttribute(e,t[e]);return r&&u(o,r),o})("meta",{name:"color-scheme",content:"normal",id:e}),n.head.appendChild(d));const m=d,h=e=>{if(!l(e))return g("to change theme");c=e},p=(e="")=>{v(r,s,e);let t="normal";return"dark"===e.slice(1,5)&&(t="dark"),m.setAttribute("content",t),S.set(a,e),s=e};p(S.get(a));const f=t.matchMedia;return f&&E(f("(prefers-color-scheme: dark)"),"change",(e=>{e.matches?p("_dark"):p()})),E(t,"keyup",(y=e=>{e.altKey&&"KeyT"===e.code&&$.change()},e=>{b&&e.isComposing||y(e)})),{list:h,set:p,change:(e=c)=>o(e)===i?p(e):l(e)?(h(e),p(e[e.indexOf(s)+1]||"")):g("to change theme"),current:()=>s};var y,b})();return e.theme=$,e})(window.base)})();