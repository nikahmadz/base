(()=>{"use strict";window.base=((e={})=>{const t="1.0.5",o=window,n=document,r=void 0,s=()=>{},i=n.documentElement||n.body,c=!0,a=!1,l=e=>typeof e,d=e=>Object.prototype.toString.call(e),h=l(s),g=d([]),u=l(""),p=Array.isArray?e=>Array.isArray(e):e=>d(e)===g,m=e=>{throw e},f=e=>m(`Cannot find: ${e}`),y=(e,t)=>m(`Invalid argument ${e}`+(t?`. Expecting (${t})`:"")),v=(e,t)=>{try{const o=JSON.parse(e,t);if(o&&"object"==typeof o)return o}catch(e){}},b=(e,t,o)=>{try{return JSON.stringify(e,t,o)}catch(e){}},_=Math.random,C=setTimeout,N=clearTimeout,w=(e,t=100)=>{let o;const n=t=>{e.apply(r,t)};return(...e)=>(N(o),o=C(n,t,e))},x=(e,t)=>{for(const o in e)if(t(e[o],o))break},S=(e,t)=>{const o=e.indexOf(t);o>=0&&(delete e[o],S(e,t))},E=e=>n.getElementById(e||""),k=e=>e.parentNode,$=(e,t=i)=>t.getElementsByTagName(e||""),I=e=>(e.hidden=a,e),J=e=>(e.hidden=c,e),T=(e,t)=>e.firstChild?e.insertBefore(t,e.firstChild):B(e,t),A=(e,t)=>{if(t)return l(t)===u?e.appendChild(n.createTextNode(t)):e.appendChild(t)},B=(e,t)=>{if(p(t))for(let o=0;o<t.length;o++)A(e,t[o]);else A(e,t)},M=()=>m("Cannot refer root element"),O=e=>(k(e)||m("Cannot remove node with no parent")).removeChild(e),H=(e,t,o)=>{const r=n.createElement(e);if(t)for(const e in t)r.setAttribute(e,t[e]);return o&&B(r,o),r},L=o.getComputedStyle?e=>o.getComputedStyle(e):e=>e.currentStyle,F=e=>new RegExp(`(^|\\s+)(${e})\\s*(?=(\\s|$))`,"g"),R=new RegExp("[\\.\\|\\s]+","g"),z=(e,t,o)=>{const n=(e,t="|")=>e.replace(R,t).trim(),r=o?n(o," "):"",s=n(r+"|"+t);return e.className=(e.className.replace(F(s),"")+(r.length?" "+r:"")).trim(),e},j=(e,t)=>z(e,r,t),D=(e,t)=>z(e,t),K="__fade",q="_fadein",G="_fadeout",P=(e,t=300)=>(C(D,t,z(e,G,K),K),e),U=e=>z(e,G,q),W=e=>z(e,"_fadein|"+K,G),X=(e,t,o)=>{I(j(e,"_peek"));const n=t();return o||J(e),D(e,"_peek"),n},Q=e=>"addEventListener"in e&&"removeEventListener"in e,V=e=>"attachEvent"in e&&"detachEvent"in e,Y=(e,t,o,n)=>{if(Q(e))return e.addEventListener(t,o,n),{h:o,stop:()=>Z(e,t,o,n)};if(V(e)){const r=s=>{o.apply(e,s),n&&n.once&&e.detachEvent("on"+t,r)};return e.attachEvent("on"+t,r),{h:r,stop:()=>e.detachEvent("on"+t,r)}}m("Fail to add event listener.")},Z=(e,t,o,n)=>{Q(e)?e.removeEventListener(t,o,n):V(e)?e.detachEvent("on"+t,o):m("Fail to remove event listener.")},ee=(e,t)=>Y(e,"click",t),te=(e,t)=>Z(e,"click",t),oe=(e,t)=>o=>{t&&o.isComposing||e(o)},ne=(e,t)=>Y(o,"keyup",oe(e,t)),re=(()=>{const e=[];return{push:t=>{l(t)===h&&e.push(t)},cancel:t=>{S(e,t)},esc:()=>{if(e.length){const t=e.pop();t&&l(t)===h&&t()}else de(n.body)}}})(),se=e=>{if(e){const t=[],n=e=>{S(t,e)},r=e=>{l(e)===h&&t.push(e)},s=()=>{for(let e=0;e<t.length;e++)t[e]&&l(t[e])===h&&t[e]()},i=t=>e.getItem(t)||"",c=(t,o)=>{e.setItem(t,o),s()},a=t=>{e.removeItem(t),s()},d=t=>parseInt(""+(e.getItem(t)||0)),g=(e,t)=>c(e,""+t),u=(t,o="{}")=>v(e.getItem(t)||o)||v(o)||{},p=(e,t,o="{}")=>c(e,b(t)||o),m=t=>{const o=e.getItem(t),n=v(o),r=o&&!n;if(r){const e=`Base found corrupted data on [${t}].`;console.log("%c"+e,"color:tomato"),C((()=>{if(confirm(`${e} Recover bad data?`)){const e=`${t}.${y()}.x`,n=`Data has been recovered as [${e}].`;ie.setString(e,o),C((()=>{console.log("%c"+n,"color:orange"),alert(n)}))}}))}return!r},f=()=>{let t=0;for(let o=0;o<e.length;o++){const n=e.key(o);n&&(t+=i(n).length)}return t},y=(t="",o=0)=>{const n=t+parseInt(Date.now()+o+"").toString(36);return null!==e.getItem(n)?y(t,o+1):n};return Y(o,"storage",s),{storage:e,getString:i,setString:c,getNumber:d,setNumber:g,getJson:u,setJson:p,validateJson:m,onChange:r,cleanOnChange:n,remove:a,size:f,newKey:y}}},ie=se(o.localStorage),ce=se(o.sessionStorage),ae=(e,t)=>{const o=t?(t.validateJson(e),t.getJson(e)):{},n=(n,r,s=true)=>(o[n]=r,t&&s?(t.setJson(e,o),c):a);return t.onChange((()=>{t.validateJson(e)||t.setJson(e,o)})),{get:e=>o[e],set:n,remove:e=>{n(e,r)}}},le=ae("base",ie),de=(()=>{const e=H("a",{tabindex:"0",class:"_no-focus"}),t=t=>{T(t,e),e.focus()};return t.clear=()=>{k(e)&&O(e)},t})(),he="_dark",ge=(()=>{const e="_color-scheme",t="theme";let s="",c=[he],a=E(e);a||(a=H("meta",{name:"color-scheme",content:"",id:e}),n.head.appendChild(a));const d=a,h=o.matchMedia,g=e=>{if(!p(e))return y("to change theme");c=e},m=(e="")=>{z(i,s,e);let o="normal";return"dark"===e.slice(1,5)&&(o="dark"),d.setAttribute("content",o),le.set(t,e),s=e};if(h){const e=h("(prefers-color-scheme: dark)");le.get(t)!==r?m(le.get(t)):e.matches?m(he):m(),Y(e,"change",(e=>{e.matches?m(he):m()}))}else m(le.get(t));return{list:g,set:m,change:(e=c)=>l(e)===u?m(e):p(e)?(g(e),m(e[e.indexOf(s)+1]||"")):y("to change theme"),current:()=>s}})(),ue=(t,o)=>{e[o]=t};return Y(o,"load",(()=>{const e=(()=>{const e="_scrub";let t,o=a,r=E(e);r||(r=H("div",{id:e,class:e}),T(n.body,r));const s=r;return{show:()=>{o||(o=c,N(t),t=C(U,0,I(s)))},hide:()=>{o&&(o=a,N(t),t=C(J,300,W(s)))}}})(),t=(()=>{const e="_error",t=E(e),r=E(e+"-action"),s=E(e+"-description");if(t){const e=e=>{d||(d=c,s&&(s.innerHTML=e?e.message?e.message.replace(/^Uncaught/,""):e:"Unexpected error occured somewhere."),N(l),I(P(t)),re.push(i),r&&de(r))},i=()=>{d&&(d=a,N(l),l=C(J,300,W(t)),re.cancel(i),de(n.body))};let l,d=a;return Y(o,"error",e),{open:e,close:i}}{const t=()=>f(e);return{open:t,close:t}}})(),i=(()=>{const e=E("_bg");if(e){const t=()=>{l||U(e),l=c},o=()=>{l&&W(e),l=a},n="_bgi _smoothest",s=(e=n,t=1e3)=>{if(d){const o=d;return d=r,C(W,100,z(o,K,e)),C(O,100+t,o),o}},i=(t,o=n,r=1e3)=>{if(t===d)return;const s=d;d=t,P(j(t,o),r),e.appendChild(t),C((()=>{s&&s!==d&&O(s)}),r)};j(e,"_app");let l=e.hidden?a:c,d=e.firstElementChild||r;return{show:t,hide:o,now:()=>d,set:i,remove:s}}{const e=()=>f("_bg");return{show:e,hide:e,now:s,set:e,remove:s}}})(),d=(()=>{const e="_overlay",t=E(e),o=E("_close-overlay");if(t){const e=(e={})=>{if(!l){l=c,N(i),e.esc&&re.push(n),o&&(e.close===c?(e.esc?o.title="Close (esc)":o.title="Close",I(o)):J(o));let r=q;e.blur&&(r="_fadein _blur"),i=C(z,0,I(t),G,r)}},n=()=>{l&&(l=a,N(i),i=C(J,300,z(t,"_fadein|_blur",G)),re.cancel(n))},r=e=>{t&&ee(t,e)},s=e=>{t&&te(t,e)};o&&ee(o,n);let i,l=a;return{show:e,hide:n,click:r,ignore:s}}{const t=()=>f(e);return{show:t,hide:t,click:t,ignore:t}}})(),g=(e={id:[]})=>{const t=e.id[0],n=E(t)||f(t),r=E(e.id[1]);n.style.touchAction="none";const s=X(n,(()=>({x:0-n.offsetWidth/2,y:0-n.offsetHeight/2}))),i={x:s.x,y:s.y},g=e.stay,u=e=>{n.style.transform=`translate(${e.x}px,${e.y}px)`},p=()=>{b&&(N(v),N(y),re.cancel(p),d.ignore(p),d.hide(),((e,t=300,o="_smooth")=>{const n=e.style;n.height=`${e.offsetHeight}px`,n.marginBottom=`-${L(e).marginBottom}`,j(e,o),C((()=>{n.height=".1px",C((()=>{n.height=n.marginBottom="",J(D(e,o))}),t)}))})(j(n,G)),y=C((()=>{b=a,l(e.onClose)===h&&e.onClose(n)}),300))},m=w((()=>{X(n,(()=>{n.style.transform="",s.x=i.x=0-n.offsetWidth/2,s.y=i.y=0-n.offsetHeight/2}),b)}));let y,v,b=a;return Y(o,"resize",m),r&&ee(r,p),e.interact&&e.interact(n,s,u),{open:(t={})=>{b||(N(v),N(y),t.esc&&re.push(p),!e.interact||t.stay||g||(s.x=i.x,s.y=i.y,u(s)),r&&(t.close===a||e.close===a?J(r):(r.title="Close",t.esc&&(r.title="Close (esc)"),I(r))),t.overlay&&(d.show({close:a,blur:t.blur}),t.esc&&d.click(p)),y=C((()=>{const o="__zoomin-c",r="_lift-1";I(z(n,"_fadeout|"+r,o)),C(z,300,n,o,r),b=c;const s=t.timeout||e.timeout;s&&(v=C(p,s))}),t.overlay?300:0))},close:p,destroy:e=>{r&&te(r,p),Z(o,"resize",m),p(),e&&l(e)===h&&C((()=>{e(n),O(n)}),300)}}},u=(()=>{const e=E("_app");if(e)return{show:()=>I(e)}})();(e=>{for(const e in["_script","_noscript","_detect"]){const t=E(e);t&&O(t)}})(),ne((e=>{"Escape"===e.code?re.esc():e.altKey&&"KeyT"===e.code?ge.change():"Tab"===e.code&&de.clear()})),u&&u.show(),e.hide(),x({app:u,scrub:e,error:t,details:(e,t)=>{const o=$("summary",e)[0],n=$("section",e)[0];if(!(e&&o&&n))throw"Malformed details: "+t;let r,s;const i=e.style,l=o.style,d=()=>{e.open?i.height=s+"px":i.height=r+"px"};ee(o,(()=>{if(isNaN(r)||isNaN(s)){i.opacity="0",i.height="";const t=e.open;e.open=a,r=e.offsetHeight,e.open=c,s=e.offsetHeight,e.open=t,d(),i.opacity=""}C((()=>{i.overflow="hidden",l.outline="0",d(),C((()=>{i.overflow="",l.outline=""}),300)}))}))},bg:i,overlay:d,modal:g,toast:(e={id:[]})=>{const t="_toaster",o=E(t)||f(t),n=e.id[0],s=e.id[1],i=E(n)||f(n);E(s)||f(s),J(i);let a=0;const l=[];return{pop:(t={})=>{const d=n+"-"+a++,h=d+"-close",u=i.cloneNode(c);u.id=d,o.appendChild(u),((E(d)||f(d)).querySelector("#"+s)||f(s)).id=h;let p=g({id:[d,h],timeout:e.timeout,onClose:()=>{p&&(p.destroy(),p=r)}})||m("Cannot create toast[modal]: "+d);return p&&(l.push(p),p.open(t)),p},close:e=>{const t=l.indexOf(e);if(t>=0){const e=l[t];e&&e.close()}}}},drawer:(e={id:[]})=>{const t=e.id[0],o=E(t)||f(t),r=E(e.id[1])||f(e.id[1]),s=E(e.id[2]),i="_slideout",l="_slidein",d="_lift-1",h=()=>{u||(u=c,re.push(g),I(o),C((()=>{U(o),z(r,i,l),de(r),C(j,300,r,d)}),100))},g=()=>{u&&(u=a,z(r,"_slidein|"+d,i),C(J,300,W(o)),re.cancel(g),de(n.body))};let u=a;return j(r,i),J(W(o)),ee(o,(e=>{e&&e.target===o&&g()})),s&&ee(s,g),{open:h,close:g,toggle:()=>{u?g():h()}}},bog:(e="_bog",t=2)=>{const o=E(e)||f(e),n=()=>{o.innerHTML=""},s=(e,s)=>(s&&n(),o.innerHTML+=b(e,r,t)+"\n");return s.clear=n,s}},ue)})),x({version:t,objectOf:d,isArray:p,cantFind:f,invalidArgs:y,JsonParse:v,JsonStringify:b,random:(e,t)=>e&&t?_()*(t-e)+e:e?_()*e:_(),trimNumber:(e,t=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER)=>e>o?o:e<t?t:e,loop:(e,t=0)=>{if(l(e)!==h)return y("for loop","Function");let o,n=a;const r=()=>{n&&(e(s),o=C(r,t))},s={start:()=>{n=c,r()},stop:()=>{N(o),n=a}};return s},each:x,find:(e,t)=>{let o;for(let n=0;!o&&n<e.length;n++)o=t(e[n],n);return o},list:(e,t)=>{const o=[];return e(o)&&t(),{check:n=>{o[n]=c;const r=e(o);return r&&t(),r}}},delay:e=>new Promise((t=>{C(t,e)})),eager:(e,t=100)=>{let o,n=a;const s=()=>{n=a};return(...i)=>(n||(n=c,e.apply(r,i)),N(o),o=C(s,t))},later:w,nodeId:E,nodeTag:$,getNode:(e,t=i)=>t.querySelector(e||""),show:I,hide:J,appendNode:A,prependNode:T,afterNode:(e,t)=>(k(e)||M()).insertBefore(t,e.nextSibling),beforeNode:(e,t)=>(k(e)||M()).insertBefore(t,e),removeNode:O,newNode:H,fa:(e="",t="fas",o="")=>(o&&(o=" "+o),H("i",{class:`_ico -fa${o}`},H("i",{class:`${t} fa-${e}`}))),nodeStyle:L,MatchClass:F,changeClass:z,addClass:j,removeClass:D,fadeIn:U,fadeOut:W,peek:X,listenTo:Y,stopListenTo:Z,ready:e=>Y(o,"load",e),onClick:ee,unClick:te,onkeypress:ne,keypress:oe,esc:re,img:(e,t,o)=>(o&&(Y(e,"load",o,{once:c}),Y(e,"error",o,{once:c})),e.src=t,e),local:ie,session:ce,Data:ae,back:(e=-1)=>()=>{o.history.go(e)},goto:(e="")=>()=>{o.location.href=e},exit:(e="/")=>{const t=o.location,r=n.referrer,s="."+btoa(t.pathname),i=r.match(t.origin);let c=ce.getString(s);return c||(c=i&&0==i.index&&r!=t.origin+t.pathname?r:e),ce.setString(s,c),()=>{const o=ce.getString(s)||e;ce.remove(s),t.href=o}},refocus:de,theme:ge,loadNumber:ie.getNumber,saveNumber:e=>t=>ie.setNumber(e,t),loadJson:ie.getJson,saveJson:e=>t=>ie.setJson(e,t),loadString:ie.getString,saveString:e=>t=>ie.setString(e,t)},ue),console.log(`%c Base v${t} `,"background:#225599;color:#eee;padding:5px;margin:10px"),e})(window.base)})();